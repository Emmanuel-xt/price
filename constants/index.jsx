import { getAllItems } from "@/lib/actions/price.actions";

export const sidebarLinks = [
  {
    imgURL: "/assets/home.svg",
    route: "/",
    label: "Home",
  },
  {
    imgURL: "/assets/search.svg",
    route: "/price",
    label: "Price",
  },
  // {
  //   imgURL: "/assets/heart.svg",
  //   route: "/activity",
  //   label: "Activity",
  // },
  {
    imgURL: "/assets/create.svg",
    route: "/add",
    label: "Add",
  },
  // {
  //   imgURL: "/assets/community.svg",
  //   route: "/communities",
  //   label: "Communities",
  // },
  {
    imgURL: "/assets/user.svg",
    route: "/profile",
    label: "Profile",
  },
];

export const HomeCategories = [
  { value: "Educational", label: "Trending", icon: "/assets/members.svg" },
  { value: "Gadgets", label: "Gadgets", icon: "/assets/request.svg" },
  { value: "Wears", label: "Wears", icon: "/assets/request.svg" },
  { value: "Toiletries", label: "Toiletries", icon: "/assets/request.svg" },
  { value: "Food", label: "Food", icon: "/assets/request.svg" },
  { value: "Others", label: "Others", icon: "/assets/request.svg" },
];
export const PriceCategories = [
  { value: "All", label: "All", icon: "/assets/members.svg" },
  { value: "Educational", label: "Educational", icon: "/assets/members.svg" },
  { value: "Gadgets", label: "Gadgets", icon: "/assets/request.svg" },
  { value: "Wears", label: "Wears", icon: "/assets/request.svg" },
  { value: "Toiletries", label: "Toiletries", icon: "/assets/request.svg" },
  { value: "Food", label: "Food Items", icon: "/assets/request.svg" },
  { value: "Services", label: "Services", icon: "/assets/request.svg" },
  { value: "Others", label: "Others", icon: "/assets/request.svg" },
];
// export const studentItems = [
//   { category: "Educational", name: "Notebook", prices: [7000], qty: 5 },
//   { category: "Educational", name: "Pens", prices: [1500, 1550, 1600, 1650, 1700, 1750], qty: 2 },
//   { category: "Educational", name: "Textbook", prices: [7500, 7600, 7700, 7800, 7900, 8000], qty: 1 },
//   { category: "Gadgets", name: "Laptop", prices: [300000, 310000, 320000, 330000, 340000, 350000], qty: 1 },
//   { category: "Educational", name: "Backpack", prices: [2000, 2100, 2200, 2300, 2400, 2500], qty: 1 },
//   { category: "Others", name: "Water Bottle", prices: [200, 210, 220, 230, 240, 250], qty: 1 },
//   { category: "Educational", name: "Calculator", prices: [400, 410, 420, 430, 440, 450], qty: 1 },
//   { category: "Gadgets", name: "USB Flash Drive", prices: [300, 310, 320, 330, 340, 350], qty: 1 },
//   { category: "Gadgets", name: "Headphones", prices: [700, 710, 720, 730, 740, 750], qty: 1 },
//   { category: "Gadgets", name: "Phones", prices: [5000, 5100, 5200, 5300, 5400, 5500], qty: 1 },
//   { category: "Gadgets", name: "AirPod", prices: [10000, 10100, 10200, 10300, 10400, 10500 ,], qty: 1 },
//   { category: "Wears", name: "T-shirts", prices: [600, 610, 620, 630, 640, 650], qty: 1 },
//   { category: "Wears", name: "Jeans", prices: [1500, 1510, 1520, 1530, 1540, 1550], qty: 1 },
//   { category: "Wears", name: "Sneakers", prices: [2500, 2510, 2520, 2530, 2540, 2550], qty: 1 },
//   { category: "Wears", name: "Baggy Jeans", prices: [1800, 1810, 1820, 1830, 1840, 1850], qty: 1 },
//   { category: "Wears", name: "Plan Trousers", prices: [2000, 2010, 2020, 2030, 2040, 2050], qty: 1 },
//   { category: "Toiletries", name: "Toothpaste", prices: [100, 110, 120, 130, 140, 150], qty: 1 },
//   { category: "Toiletries", name: "Shampoo", prices: [250, 260, 270, 280, 290, 300], qty: 1 },
//   { category: "Toiletries", name: "Soap", prices: [50, 60, 70, 80, 90, 100], qty: 1 },
//   { category: "Toiletries", name: "Dettol", prices: [150, 160, 170, 180, 190, 200], qty: 1 },
//   { category: "Toiletries", name: "Tissue", prices: [50, 55, 60, 65, 70, 75], qty: 1 },
//   { category: "Food", name: "Instant Noodles", prices: [80, 85, 90, 95, 100, 105], qty: 1 },
//   { category: "Food", name: "Rice (5kg)", prices: [700, 710, 720, 730, 740, 750], qty:1 },
//   { category: "Food", name: "Canned Beans", prices: [120, 125, 130, 135, 140, 145], qty: 1 },
//   { category: "Food", name: "Bread", prices: [150, 155, 160, 165, 170, 175], qty: 1 },
//   { category: "Food", name: "Milk (1 liter)", prices: [200, 205, 210, 215, 220, 225], qty: 1 },
//   { category: "Educational", name: "Binder", prices: [800, 805, 810, 815, 820, 825 , 900], qty: 1 },
//   { category: "Others", name: "Hoodie", prices: [2000, 2010, 2020, 2030, 2040, 2050], qty: 1 },
//   { category: "Toiletries", name: "Deodorant", prices: [300, 305, 310, 315, 320, 325], qty: 1 },
//   { category: "Others", name: "Pasta", prices: [150, 155, 160, 165, 170, 175], qty: 1 },
//   { category: "Educational", name: "Folders (Pack of 3)", prices: [300, 305, 310, 315, 320, 325 , 242], qty: 1 },
//   { category: "Gadgets", name: "Wireless Mouse", prices: [800, 805, 810, 815, 820, 825 ,800 , 810,90 ,], qty: 1 },
//   { category: "Wears", name: "Flip-flops", prices: [500, 505, 510, 515, 520, 525], qty: 1 },
//   { category: "Toiletries", name: "Toilet Paper (Pack of 4)", prices: [200, 205, 210, 215, 220, 225], qty: 1 },
//   { category: "Food", name: "Eggs (Dozen)", prices: [400, 405, 410, 415, 420, 425], qty: 1 }
// ];
export const engineeringDepartments = [
  "Mechanical Engineering",
  "Civil Engineering",
  "Electrical/Electronic Engineering",
  "Computer Engineering",
  "Petroleum Engineering",
  "Chemical Engineering",
  "Agricultural Engineering",
  "Polymer&Textile Engineering",
]
export const filterOutliers = (prices) => {
  // console.log('about to perform the filter function')
  // console.log({prices})
  // Calculate the frequency of each price
  const priceFrequency = prices.reduce((acc, price) => {
    acc[price] = (acc[price] || 0) + 1;
    return acc;
  }, {});
  // console.log({priceFrequency})

  // Find the price that appears most frequently
  const maxFrequency = Math.max(...Object.values(priceFrequency));
  const maxFrequencyPercentage = (maxFrequency / prices.length) * 100;
  // console.log({maxFrequency})
  // console.log({maxFrequencyPercentage})

  if (maxFrequencyPercentage >= 40) {
    const majorityPrices = Object.keys(priceFrequency)
      .filter((price) => priceFrequency[price] === maxFrequency)
      .map(Number);
    return calculateAverage(majorityPrices);
  }

  // Calculate the median price
  const sortedPrices = prices.sort((a, b) => a - b);
  const medianIndex = Math.floor(sortedPrices.length / 2);
  const medianPrice = sortedPrices[medianIndex];
  // console.log({sortedPrices})
  // console.log({medianIndex})
  // console.log({medianPrice})

  // Calculate the acceptable price range around the median
  // Calculate the acceptable price range around the median based on median price
  let deviation = 0;
  if (medianPrice <= 500) {
    deviation = 100;
  } else if (medianPrice <= 1000) {
    deviation = 150;
  } else if (medianPrice <= 2000) {
    deviation = 200;
  } else if (medianPrice <= 5000) {
    deviation = 500;
  } else if (medianPrice <= 10000) {
    deviation = 750;
  } else if (medianPrice <= 20000) {
    deviation = 1000;
  }
  // Add more conditions for other ranges as needed

  // Calculate the acceptable price range
  const minPrice = medianPrice - deviation;
  const maxPrice = medianPrice + deviation;

  // Filter out prices within the acceptable range
  const filteredPrices = prices.filter(
    (price) => price >= minPrice && price <= maxPrice
  );
  // console.log({ filteredPrices });

  // Calculate the average based on the filtered prices
  const average = calculateAverage(filteredPrices);
  return average;
};

export const truthy = (prices) => {
  const priceFrequency = prices.reduce((acc, price) => {
    acc[price] = (acc[price] || 0) + 1;
    return acc;
  }, {});
  const maxFrequency = Math.max(...Object.values(priceFrequency));
  const maxFrequencyPercentage = (maxFrequency / prices.length) * 100;
  if (maxFrequencyPercentage >= 40) {
    const majorityPrices = Object.keys(priceFrequency)
      .filter((price) => priceFrequency[price] === maxFrequency)
      .map(Number);
    return calculateAverage(majorityPrices);
  }
  const sortedPrices = prices.sort((a, b) => a - b);
  const medianIndex = Math.floor(sortedPrices.length / 2);
  const medianPrice = sortedPrices[medianIndex];
  let deviation = 0;
  if (medianPrice <= 500) {
    deviation = 100;
  } else if (medianPrice <= 1000) {
    deviation = 150;
  } else if (medianPrice <= 2000) {
    deviation = 200;
  } else if (medianPrice <= 5000) {
    deviation = 500;
  } else if (medianPrice <= 10000) {
    deviation = 750;
  } else if (medianPrice <= 20000) {
    deviation = 1000;
  }
  const minPrice = medianPrice - deviation;
  const maxPrice = medianPrice + deviation;
  const filteredPrices = prices.filter(
    (price) => price >= minPrice && price <= maxPrice
  );
  return Array.isArray(filteredPrices) ? filteredPrices : [filteredPrices];
};

export const calculateAverage = (prices) => {
  if (prices.length === 0) {
    return 0;
  }

  // Calculate the sum of prices
  // console.log("prices =", prices);/
  const sum = prices.reduce((acc, price) => acc + price, 0);

  // Calculate the average
  const average = sum / prices.length;

  return average;
};

export const roundPrice = (averagePrice) => {
  const lastTwoDigits = averagePrice % 100;
  let roundedPrice;

  if (lastTwoDigits <= 24) {
    roundedPrice = Math.floor(averagePrice / 100) * 100; // Round down to nearest 100
  } else if (lastTwoDigits <= 59) {
    roundedPrice = Math.floor(averagePrice / 100) * 100 + 50; // Round up to nearest 50
  } else {
    roundedPrice = Math.floor(averagePrice / 100) * 100 + 100; // Round up to nearest 100
  }

  return roundedPrice.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};

const numberSplit = (number) =>
  number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

export const InfoCategories = [
  { value: "Shops", label: "Shops", icon: "/assets/request.svg" },
  { value: "News", label: "News", icon: "/assets/request.svg" },
  { value: "Announcement", label: "Announcement", icon: "/assets/members.svg" },
];

export const ItemTabs = ["Price", "Info", "Slashed"];


export function date(timestamp) {
  const date = new Date(timestamp);

  // Get various date components
  const year = date.getFullYear();
  const month = ('0' + (date.getMonth() + 1)).slice(-2); // Months are zero-based
  const day = ('0' + date.getDate()).slice(-2);
  const hours = ('0' + date.getHours()).slice(-2);
  const minutes = ('0' + date.getMinutes()).slice(-2);
  const seconds = ('0' + date.getSeconds()).slice(-2);

  // Create a string representation of the date and time
  const dateTimeString = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;

  return dateTimeString;
}


export function formatDate(date) {
  const now = new Date();
  const diff = Math.floor((now - date) / 1000); 
  // console.log({now})
  // console.log({diff})
  // console.log({date})

  const seconds = diff;
  const minutes = Math.floor(diff / 60);
  const hours = Math.floor(minutes / 60);
  const days = Math.floor(hours / 24);

  if (days === 0) {
      if (hours === 0) {
          if (minutes === 0) {
              return 'just now';
          }
          return `${minutes} min${minutes > 1 ? 's' : ''} ago`;
      }
      return `${hours} hour${hours > 1 ? 's' : ''} ago`;
  } else if (days === 1) {
      return 'yesterday';
  } else {
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('en-US', options);
  }
}

